<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Magical Halloween Birthday Surprise</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Playfair+Display:wght@600&family=Pacifico&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Creepster&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, #1a0633, #2c0b3f, #1a0633);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            overflow: hidden;
            font-family: 'Playfair Display', serif;
            color: #fff;
            padding: 20px;
            position: relative;
        }
        
        /* Moon and stars background */
        .moon {
            position: absolute;
            top: 50px;
            right: 50px;
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, #f9f3c5, #f0e68c);
            border-radius: 50%;
            box-shadow: 0 0 50px rgba(249, 243, 197, 0.7);
            z-index: 1;
            animation: float 8s infinite ease-in-out;
        }
        
        .stars {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
        
        .star {
            position: absolute;
            background: #fff;
            border-radius: 50%;
            animation: twinkle 3s infinite;
        }
        
        /* Cute Pumpkin styling */
        .pumpkin-container {
            position: relative;
            width: 300px;
            height: 300px;
            margin: 0 auto 30px;
            cursor: pointer;
            transition: transform 0.3s ease;
            z-index: 10;
            filter: drop-shadow(0 0 25px rgba(255, 107, 0, 0.9));
            animation: float 4s infinite ease-in-out;
        }
        
        .pumpkin-container:hover {
            transform: scale(1.05) rotate(5deg);
            filter: drop-shadow(0 0 30px rgba(255, 200, 0, 1));
        }
        
        .pumpkin {
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #ff6b00, #ff8c00, #ff6b00);
            border-radius: 50%;
            box-shadow: 
                0 0 40px rgba(255, 107, 0, 0.9),
                0 0 80px rgba(255, 107, 0, 0.7),
                inset 0 -20px 40px rgba(0, 0, 0, 0.3);
            z-index: 10;
        }
        
        .stem {
            position: absolute;
            top: -40px;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 50px;
            background: linear-gradient(to bottom, #2c8c2c, #1f5e1f);
            border-radius: 10px;
            box-shadow: inset 0 -5px 10px rgba(0, 0, 0, 0.5);
            z-index: 10;
            animation: stemWiggle 3s infinite ease-in-out;
        }
        
        .eye {
            position: absolute;
            width: 50px;
            height: 50px;
            background: #1a0633;
            border-radius: 50%;
            top: 90px;
            animation: blink 5s infinite;
            z-index: 10;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.7);
        }
        
        .left-eye {
            left: 60px;
            transform: rotate(10deg);
        }
        
        .right-eye {
            right: 60px;
            transform: rotate(-10deg);
        }
        
        .nose {
            position: absolute;
            width: 30px;
            height: 30px;
            background: #1a0633;
            border-radius: 50%;
            top: 160px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
            box-shadow: 0 0 8px rgba(0, 0, 0, 0.7);
        }
        
        .mouth {
            position: absolute;
            width: 160px;
            height: 70px;
            background: #1a0633;
            border-radius: 0 0 80px 80px;
            bottom: 70px;
            left: 50%;
            transform: translateX(-50%);
            overflow: hidden;
            z-index: 10;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.7);
        }
        
        .tongue {
            position: absolute;
            width: 50px;
            height: 0;
            background: linear-gradient(to bottom, #ff3366, #cc0044);
            border-radius: 30px 30px 0 0;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            animation: tongue 4s infinite;
            z-index: 10;
        }
        
        .blush {
            position: absolute;
            width: 40px;
            height: 20px;
            background: rgba(255, 100, 100, 0.4);
            border-radius: 50%;
            top: 140px;
            z-index: 9;
        }
        
        .left-blush {
            left: 40px;
        }
        
        .right-blush {
            right: 40px;
        }
        
        .pop-me {
            position: absolute;
            bottom: -60px;
            left: 50%;
            transform: translateX(-50%);
            font-family: 'Pacifico', cursive;
            font-size: 2.2rem;
            color: #ffcc00;
            text-shadow: 
                0 0 10px #ff0000,
                0 0 20px #ff5500;
            animation: pulse 1.5s infinite, glow 2s infinite alternate;
            z-index: 10;
            background: rgba(0, 0, 0, 0.3);
            padding: 5px 15px;
            border-radius: 30px;
            border: 2px solid #ffcc00;
        }
        
        /* Sparkle effect */
        .sparkle {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #fff;
            border-radius: 50%;
            z-index: 11;
            animation: sparkle 2s infinite;
            pointer-events: none;
        }
        
        /* Birthday Card - Enhanced */
        .card-container {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.1);
            background: linear-gradient(135deg, #ff3366, #ff6b00, #ff3366);
            border-radius: 25px;
            box-shadow: 
                0 0 60px rgba(255, 51, 102, 0.8),
                0 0 100px rgba(255, 107, 0, 0.6);
            width: 95%;
            max-width: 650px;
            max-height: 90vh;
            overflow: hidden;
            z-index: 1000;
            border: 4px solid #ffcc00;
            animation: cardAppear 0.8s forwards 0.2s;
            perspective: 1000px;
        }
        
        .card-container::before {
            content: "";
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            background: linear-gradient(45deg, #ff0000, #ff9900, #ffff00, #ff9900, #ff0000);
            background-size: 400% 400%;
            z-index: -1;
            animation: glitter 3s ease infinite;
            border-radius: 30px;
            opacity: 0.7;
        }
        
        .card-content-wrapper {
            max-height: 90vh;
            overflow-y: auto;
            padding: 40px;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 20px;
        }
        
        .card-content {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(245, 245, 245, 0.95));
            border-radius: 20px;
            padding: 50px 40px;
            box-shadow: 
                0 5px 25px rgba(0, 0, 0, 0.1),
                inset 0 0 20px rgba(255, 51, 102, 0.1);
            position: relative;
            overflow: hidden;
            transform-style: preserve-3d;
            transform: rotateY(10deg);
            animation: cardFloat 8s infinite ease-in-out;
        }
        
        .card-content::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><path d="M50,5 C70,5 85,20 85,40 C85,60 70,75 50,75 C30,75 15,60 15,40 C15,20 30,5 50,5 Z" fill="none" stroke="rgba(255,51,102,0.1)" stroke-width="1"/></svg>');
            opacity: 0.2;
            z-index: -1;
        }
        
        .card-title {
            font-family: 'Dancing Script', cursive;
            font-size: 4.5rem;
            color: #ff3366;
            margin-bottom: 25px;
            text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.2);
            position: relative;
            text-align: center;
            animation: titleGlow 3s infinite alternate;
        }
        
        .card-title::after {
            content: "";
            display: block;
            width: 200px;
            height: 4px;
            background: linear-gradient(to right, transparent, #ffcc00, transparent);
            margin: 15px auto;
            border-radius: 2px;
        }
        
        .message {
            font-size: 1.5rem;
            line-height: 1.8;
            color: #333;
            margin-bottom: 30px;
            text-align: center;
            min-height: auto;
            padding: 30px;
            border: 3px dashed #ff3366;
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.85);
            outline: none;
            font-family: 'Playfair Display', serif;
            position: relative;
            box-shadow: inset 0 0 15px rgba(255, 51, 102, 0.1);
        }
        
        .signature {
            font-family: 'Pacifico', cursive;
            font-size: 2.8rem;
            color: #ff3366;
            text-align: right;
            margin-top: 30px;
            position: relative;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.2);
        }
        
        .signature::before {
            content: "";
            position: absolute;
            top: -15px;
            right: 0;
            width: 250px;
            height: 2px;
            background: linear-gradient(to left, #ffcc00, transparent);
        }
        
        .hearts {
            position: absolute;
            font-size: 1.5rem;
            color: #ff3366;
            z-index: 5;
            opacity: 0;
            animation: floatUp 6s infinite linear;
        }
        
        .rose {
            position: absolute;
            bottom: 20px;
            left: 20px;
            font-size: 3rem;
            animation: floatRose 5s infinite ease-in-out;
            color: #ff3366;
        }
        
        .ghost {
            position: absolute;
            bottom: 20px;
            right: 20px;
            font-size: 2.5rem;
            animation: floatGhost 6s infinite ease-in-out;
        }
        
        /* Close button for the card */
        .close-card {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 45px;
            height: 45px;
            background: #ff3366;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 1010;
            border: 2px solid #ffcc00;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.4);
            transition: all 0.3s ease;
        }
        
        .close-card:hover {
            transform: rotate(90deg) scale(1.1);
            background: #ff0000;
            box-shadow: 0 0 20px rgba(255, 0, 0, 0.7);
        }
        
        .close-card::before,
        .close-card::after {
            content: '';
            position: absolute;
            width: 25px;
            height: 4px;
            background: #fff;
            border-radius: 2px;
        }
        
        .close-card::before {
            transform: rotate(45deg);
        }
        
        .close-card::after {
            transform: rotate(-45deg);
        }
        
        /* Scrollbar styling */
        .card-content-wrapper::-webkit-scrollbar {
            width: 12px;
        }
        
        .card-content-wrapper::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }
        
        .card-content-wrapper::-webkit-scrollbar-thumb {
            background: linear-gradient(45deg, #ff3366, #ff6b00);
            border-radius: 10px;
            border: 2px solid #ffcc00;
        }
        
        /* Animations */
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }
        
        @keyframes stemWiggle {
            0%, 100% { transform: translateX(-50%) rotate(0deg); }
            25% { transform: translateX(-50%) rotate(5deg); }
            75% { transform: translateX(-50%) rotate(-5deg); }
        }
        
        @keyframes tongue {
            0%, 100% { height: 0; }
            50% { height: 60px; }
        }
        
        @keyframes blink {
            0%, 45%, 55%, 100% { height: 50px; }
            48%, 52% { height: 10px; }
        }
        
        @keyframes pulse {
            0%, 100% { transform: translateX(-50%) scale(1); }
            50% { transform: translateX(-50%) scale(1.1); }
        }
        
        @keyframes glow {
            0% { text-shadow: 0 0 10px #ff0000, 0 0 20px #ff5500; }
            100% { text-shadow: 0 0 15px #ff0000, 0 0 30px #ff9900; }
        }
        
        @keyframes cardAppear {
            0% { transform: translate(-50%, -50%) scale(0.1); opacity: 0; }
            70% { transform: translate(-50%, -50%) scale(1.05); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }
        
        @keyframes cardFloat {
            0%, 100% { transform: rotateY(10deg) translateY(0); }
            50% { transform: rotateY(15deg) translateY(-10px); }
        }
        
        @keyframes glitter {
            0% { background-position: 0% 50%; }
            100% { background-position: 100% 50%; }
        }
        
        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }
        
        @keyframes floatRose {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            25% { transform: translateY(-15px) rotate(10deg); }
            50% { transform: translateY(0) rotate(0deg); }
            75% { transform: translateY(-15px) rotate(-10deg); }
        }
        
        @keyframes floatGhost {
            0%, 100% { transform: translateY(0); }
            25% { transform: translateY(-20px); }
            50% { transform: translateY(0); }
            75% { transform: translateY(-20px); }
        }
        
        @keyframes titleGlow {
            0% { text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.2); }
            100% { text-shadow: 2px 2px 15px rgba(255, 51, 102, 0.6), 0 0 20px rgba(255, 204, 0, 0.5); }
        }
        
        @keyframes sparkle {
            0% { opacity: 0; transform: scale(0); }
            50% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: scale(0) translate(100px, -100px); }
        }
        
        @keyframes floatUp {
            0% { transform: translateY(0) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
        }
        
        /* Fireflies */
        .firefly {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #ffcc00;
            border-radius: 50%;
            box-shadow: 0 0 15px #ffcc00;
            z-index: 2;
            animation: fireflyMove 15s infinite linear;
        }
        
        @keyframes fireflyMove {
            0% { transform: translate(0, 0); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translate(100px, -100px); opacity: 0; }
        }
        
        /* Responsive design */
        @media (max-width: 768px) {
            .card-content-wrapper {
                padding: 20px;
            }
            
            .card-content {
                padding: 30px 20px;
            }
            
            .card-title {
                font-size: 3.5rem;
            }
            
            .message {
                font-size: 1.3rem;
                padding: 20px;
            }
            
            .signature {
                font-size: 2.3rem;
            }
            
            .pumpkin-container {
                width: 250px;
                height: 250px;
            }
            
            .moon {
                width: 80px;
                height: 80px;
                top: 30px;
                right: 30px;
            }
            
            .pop-me {
                font-size: 1.8rem;
            }
        }
        
        @media (max-width: 480px) {
            .card-content-wrapper {
                padding: 15px;
            }
            
            .card-content {
                padding: 25px 15px;
            }
            
            .card-title {
                font-size: 2.8rem;
            }
            
            .message {
                font-size: 1.2rem;
                padding: 15px;
            }
            
            .signature {
                font-size: 2rem;
            }
            
            .pumpkin-container {
                width: 220px;
                height: 220px;
            }
            
            .eye {
                width: 35px;
                height: 35px;
                top: 80px;
            }
            
            .left-eye {
                left: 50px;
            }
            
            .right-eye {
                right: 50px;
            }
            
            .nose {
                top: 140px;
            }
            
            .mouth {
                width: 130px;
                height: 50px;
                bottom: 60px;
            }
            
            .pop-me {
                font-size: 1.6rem;
                bottom: -50px;
            }
        }
    </style>
</head>
<body>
    <!-- Background elements -->
    <div class="moon"></div>
    
    <div class="stars" id="stars"></div>
    
    <!-- Fireflies -->
    <div id="fireflies"></div>
    
    <!-- Pumpkin and Card Container -->
    <div class="container">
        <div class="pumpkin-container" id="pumpkin">
            <div class="pumpkin">
                <div class="stem"></div>
                <div class="blush left-blush"></div>
                <div class="blush right-blush"></div>
                <div class="eye left-eye"></div>
                <div class="eye right-eye"></div>
                <div class="nose"></div>
                <div class="mouth">
                    <div class="tongue"></div>
                </div>
            </div>
            <div class="pop-me">Pop meü§™</div>
        </div>
        
        <div class="card-container" id="card">
            <div class="close-card" id="closeCard"></div>
            <div class="card-content-wrapper">
                <div class="card-content">
                    <h2 class="card-title">Happy Birthday My Pookie</h2>
                    <div class="rose">üåπ</div>
                    <div class="ghost">üëª</div>
                    <div class="message" contenteditable="true">
                       My dearest pumpkin penguin, üéÉüêß<br><br>
                        
On this special day, I wanted to create something as unique as you are! You light up my life like the brightest star of the night sky. You make it better by just be there in it. üòä
Wishing you a birthday, a new year of your life filled with magic, laughter, and all the things that make you smile. You're the most amazing person I know, and I'm so grateful to have you in my life
With all my love,
                    </div>
                    <div class="signature">Tom</div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const pumpkin = document.getElementById('pumpkin');
            const card = document.getElementById('card');
            const closeCard = document.getElementById('closeCard');
            const message = document.querySelector('.message');
            const stars = document.getElementById('stars');
            const fireflies = document.getElementById('fireflies');
            const body = document.body;
            
            // Create stars
            for (let i = 0; i < 120; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.width = Math.random() * 4 + 1 + 'px';
                star.style.height = star.style.width;
                star.style.left = Math.random() * 100 + 'vw';
                star.style.top = Math.random() * 100 + 'vh';
                star.style.animationDelay = Math.random() * 3 + 's';
                stars.appendChild(star);
            }
            
            // Create fireflies
            for (let i = 0; i < 20; i++) {
                const firefly = document.createElement('div');
                firefly.className = 'firefly';
                firefly.style.left = Math.random() * 100 + 'vw';
                firefly.style.top = Math.random() * 100 + 'vh';
                firefly.style.animationDelay = Math.random() * 15 + 's';
                firefly.style.animationDuration = 10 + Math.random() * 20 + 's';
                fireflies.appendChild(firefly);
            }
            
            // Create sparkles around pumpkin
            setInterval(() => {
                if (pumpkin.style.display !== 'none') {
                    createSparkle();
                }
            }, 500);
            
            pumpkin.addEventListener('click', function() {
                // Create confetti effect
                createConfetti();
                
                // Add squash animation
                this.style.animation = 'squash 0.5s forwards';
                
                // Hide pumpkin and show card after animation
                setTimeout(() => {
                    pumpkin.style.display = 'none';
                    card.style.display = 'block';
                    
                    // Create floating hearts
                    createHearts();
                }, 500);
                
                // Play pop sound
                playPopSound();
                
                // Play birthday melody after a delay
                setTimeout(playBirthdayMelody, 800);
            });
            
            closeCard.addEventListener('click', function() {
                card.style.display = 'none';
                pumpkin.style.display = 'block';
                pumpkin.style.animation = 'float 4s infinite ease-in-out';
            });
            
            function createSparkle() {
                const sparkle = document.createElement('div');
                sparkle.className = 'sparkle';
                
                // Position around pumpkin
                const angle = Math.random() * Math.PI * 2;
                const distance = 180 + Math.random() * 40;
                const x = 150 + Math.cos(angle) * distance;
                const y = 150 + Math.sin(angle) * distance;
                
                sparkle.style.left = x + 'px';
                sparkle.style.top = y + 'px';
                sparkle.style.animationDuration = (1 + Math.random() * 2) + 's';
                
                pumpkin.appendChild(sparkle);
                
                // Remove after animation
                setTimeout(() => {
                    sparkle.remove();
                }, 2000);
            }
            
            function createHearts() {
                for (let i = 0; i < 20; i++) {
                    const heart = document.createElement('div');
                    heart.className = 'hearts';
                    heart.innerHTML = '‚ù§Ô∏è';
                    
                    // Random position
                    heart.style.left = Math.random() * 100 + 'vw';
                    heart.style.fontSize = (20 + Math.random() * 20) + 'px';
                    heart.style.animationDuration = (3 + Math.random() * 7) + 's';
                    heart.style.animationDelay = Math.random() * 2 + 's';
                    
                    body.appendChild(heart);
                    
                    // Remove after animation
                    setTimeout(() => {
                        heart.remove();
                    }, 8000);
                }
            }
            
            function createConfetti() {
                const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff', '#ff9900'];
                const container = document.body;
                
                for (let i = 0; i < 200; i++) {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.top = '-20px';
                    confetti.style.width = (10 + Math.random() * 20) + 'px';
                    confetti.style.height = confetti.style.width;
                    confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                    confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
                    container.appendChild(confetti);
                    
                    // Animate confetti falling
                    const animation = confetti.animate([
                        { top: '-20px', opacity: 1, transform: `rotate(0deg)` },
                        { top: Math.random() * 100 + 50 + 'vh', opacity: 1 },
                        { top: '100vh', opacity: 0 }
                    ], {
                        duration: 2000 + Math.random() * 3000,
                        easing: 'cubic-bezier(0,0.9,0.57,1)',
                        delay: Math.random() * 500
                    });
                    
                    // Remove confetti after animation
                    animation.onfinish = () => confetti.remove();
                }
            }
            
            function playPopSound() {
                // Create audio context
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                // Configure sound
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(500, audioContext.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(50, audioContext.currentTime + 0.4);
                
                gainNode.gain.setValueAtTime(0.6, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.4);
                
                // Play and stop
                oscillator.start();
                setTimeout(() => {
                    oscillator.stop();
                }, 400);
            }
            
            function playBirthdayMelody() {
                // Create audio context
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                
                // Notes for "Happy Birthday" melody
                const melody = [
                    { note: 523.25, duration: 0.4 }, // C5
                    { note: 523.25, duration: 0.4 }, // C5
                    { note: 587.33, duration: 0.8 }, // D5
                    { note: 523.25, duration: 0.8 }, // C5
                    { note: 698.46, duration: 0.8 }, // F5
                    { note: 659.25, duration: 1.2 }, // E5
                    { note: 0, duration: 0.2 },      // Rest
                    
                    { note: 523.25, duration: 0.4 }, // C5
                    { note: 523.25, duration: 0.4 }, // C5
                    { note: 587.33, duration: 0.8 }, // D5
                    { note: 523.25, duration: 0.8 }, // C5
                    { note: 783.99, duration: 0.8 }, // G5
                    { note: 698.46, duration: 1.2 }, // F5
                    { note: 0, duration: 0.2 },      // Rest
                    
                    { note: 523.25, duration: 0.4 }, // C5
                    { note: 523.25, duration: 0.4 }, // C5
                    { note: 1046.50, duration: 0.8 }, // C6
                    { note: 880.00, duration: 0.8 }, // A5
                    { note: 698.46, duration: 0.8 }, // F5
                    { note: 659.25, duration: 0.8 }, // E5
                    { note: 587.33, duration: 1.0 }, // D5
                    { note: 0, duration: 0.2 },      // Rest
                    
                    { note: 987.77, duration: 0.4 }, // B5
                    { note: 987.77, duration: 0.4 }, // B5
                    { note: 880.00, duration: 0.8 }, // A5
                    { note: 698.46, duration: 0.8 }, // F5
                    { note: 783.99, duration: 0.8 }, // G5
                    { note: 698.46, duration: 1.2 }  // F5
                ];
                
                let time = audioContext.currentTime;
                
                melody.forEach(tone => {
                    if (tone.note !== 0) {
                        const oscillator = audioContext.createOscillator();
                        const gainNode = audioContext.createGain();
                        
                        oscillator.connect(gainNode);
                        gainNode.connect(audioContext.destination);
                        
                        oscillator.type = 'sine';
                        oscillator.frequency.value = tone.note;
                        
                        gainNode.gain.setValueAtTime(0.3, time);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, time + tone.duration);
                        
                        oscillator.start(time);
                        oscillator.stop(time + tone.duration);
                    }
                    time += tone.duration;
                });
            }
            
            // Allow saving the message
            message.addEventListener('blur', function() {
                localStorage.setItem('birthdayMessage', this.innerHTML);
            });
            
            // Load saved message if exists
            const savedMessage = localStorage.getItem('birthdayMessage');
            if (savedMessage) {
                message.innerHTML = savedMessage;
            }
            
            // Handle ESC key to close card
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && card.style.display === 'block') {
                    card.style.display = 'none';
                    pumpkin.style.display = 'block';
                    pumpkin.style.animation = 'float 4s infinite ease-in-out';
                }
            });
        });
    </script>
</body>
</html>
